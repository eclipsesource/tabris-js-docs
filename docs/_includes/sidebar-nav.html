{% include base.html %}
{% assign current = page.path | replace: '.md', '.html' %}
{% assign subdir = page.path | split:'/' | first %}
<ul id="main-nav" class="nav nav-sidebar">
  {% for section in toc %}
    {% assign sectionId = section.title | slugify | prepend: 'nav-' %}
    {% assign active = false %}
    {% for item in section.pages %}
      {% assign url = item.url | prepend: '/' | prepend: subdir %}
      {% if current == url %}{% assign active = true %}{% endif %}
    {% endfor %}
    {% if active %}
  <li class="panel active">
    <a href="#{{ sectionId }}" data-parent="#main-nav" data-toggle="collapse">{{ section.title }}</a>
    <ul id="{{ sectionId | slugify }}" class="nav nav-section collapse in">
    {% else %}
  <li class="panel">
    <a href="#{{ sectionId }}" data-parent="#main-nav" data-toggle="collapse">{{ section.title }}</a>
    <ul id="{{ sectionId | slugify }}" class="nav nav-section collapse">
    {% endif %}
    {% for item in section.pages %}
      {% assign url = item.url | prepend: '/' | prepend: subdir %}
      {% assign relurl = url | prepend: '/' | prepend: base %}
      {% if current == url %}
      <li class="active"><a>{{ item.title }}</a></li>
      {% else %}
      <li><a href="{{ relurl }}">{{ item.title }}</a></li>
      {% endif %}
    {% endfor %}
    </ul>
  </li>
  {% endfor %}
</ul>
