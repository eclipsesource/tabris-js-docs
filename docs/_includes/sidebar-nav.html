{% assign current = page.path | replace:'.md','.html' | relative_url %}
<ul id="main-nav" class="nav nav-sidebar">
  {% for section in include.toc %}
    {% assign sectionId = section.title | slugify %}
    {% assign active = false %}
    {% for item in section.pages %}
      {% assign url = item.url | prepend:'/' | prepend:include.version | relative_url %}
      {% if current == url %}{% assign active = true %}{% endif %}
    {% endfor %}
    {% if active %}
  <li class="panel active">
    <a href="#{{ sectionId }}" data-parent="#main-nav" data-toggle="collapse">{{ section.title }}</a>
    <ul id="{{ sectionId | slugify }}" class="nav nav-section collapse in">
    {% else %}
  <li class="panel">
    <a href="#{{ sectionId }}" data-parent="#main-nav" data-toggle="collapse">{{ section.title }}</a>
    <ul id="{{ sectionId | slugify }}" class="nav nav-section collapse">
    {% endif %}
    {% for item in section.pages %}
      {% if item.url contains "://" %}
      {% assign url = item.url %}
      {% else %}
      {% assign url = item.url | prepend:'/' | prepend:include.version | relative_url %}
      {% endif %}
      {% if current == url %}
      <li class="active"><a>{{ item.title }}</a></li>
      {% else %}
      <li><a href="{{ url }}">{{ item.title }}</a></li>
      {% endif %}
    {% endfor %}
    </ul>
  </li>
  {% endfor %}
</ul>
